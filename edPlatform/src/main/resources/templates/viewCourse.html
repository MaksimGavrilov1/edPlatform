<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      th:include="layout :: page">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<div th:fragment="content" style="max-width: 100%;">
    <div th:if="${joinedFlag and sub.getStatus().getValue().equals('Закрыт')}" class="container" style="width: 90%; background: #ffffff; margin-top: 10px; border: 1px; border-radius: 5px;">
        <h5 th:text="${'Курс' + course.getName() + 'закрыт'}">Курс закрыт</h5>
    </div>
    <div th:if="${(joinedFlag and  !sub.getStatus().getValue().equals('Закрыт')) or (!joinedFlag)}" class="container" style="width: 90%; background: #ffffff; margin-top: 10px; border: 1px; border-radius: 5px;">
        <div class="row" style="padding:10px;">
            <h3 th:text="${course.getName()}"></h3>
        </div>
        <div class="row" style="margin: 5px">
            <h5 th:text="${'Автор: ' + course.getAuthor().toString()}"></h5>
        </div>
        <div class="row" style="margin: 3px">
            <p th:text="${course.getDescription()}"></p>
        </div>
        <div class="row justify-content-md-center" style="margin-top: 10px;">
            <h5>Темы курса:</h5>
        </div>

        <div th:if="${!joinedFlag}" class="row justify-content-md-center" style="margin: 20px"
             th:each="theme : ${course.getThemes()}">
            <div>
                <h5 th:text="${theme.getName()}"></h5>
                <p th:if="${joinedFlag == true}" th:text="${theme.getLectureMaterial()}"></p>
            </div>
        </div>
        <div th:if="${joinedFlag}" class="row" style="margin: 20px" th:each="theme : ${course.getThemes()}">
            <div>
                <h5 th:text="${theme.getName()}"></h5>
                <p th:if="${joinedFlag == true}" th:text="${theme.getLectureMaterial()}"></p>
            </div>
        </div>
        <div th:if="${!joinedFlag}" class="row justify-content-md-center">
            <h6 th:text="${'Дней для прохождения курса: ' + course.getActiveDays()}"></h6>
        </div>
        <div class="row justify-content-md-center">
            <a style="margin-bottom: 15px;" class="btn btn-primary" th:if="${!joinedFlag}"
               th:href="@{/courses/joinCourse/{id}(id=${course.id})}">Подписаться</a>
        </div>
    </div>
    <div th:if="${joinedFlag and !sub.getStatus().getValue().equals('Закрыт') and !sub.getStatus().getValue().equals('Не активен')}" class="container"
         style="width: 70%; background: #ffffff; margin-top: 10px; margin-bottom: 20px; border: 1px; border-radius: 5px;">
        <div class="row justify-content-md-center">
            <h6 style="margin: 15px;">Результаты прохождения теста</h6>
        </div>
        <div class="row justify-content-md-center" th:if="${attemptsLeft != 0}" style="margin: 10px;">
            <p th:text="${'Попыток осталось: ' + attemptsLeft}"></p>
        </div>
        <div class="row justify-content-md-center" th:if="${attemptsLeft == 0}" style="margin: 10px;">
            <p>У вас закончились попытки</p>
        </div>
        <div class="row justify-content-md-center" style="margin: 10px;">
            <a th:if="${joinedFlag == true} and ${attemptsLeft > 0}" class="btn btn-primary"
               th:href="@{/test/render/{id}(id=${course.id})}">
                Пройти тест
            </a>
        </div>
        <div  class="row justify-content-md-center" style="margin: 5px;">
            <table class="table">
                <caption th:if="${attempts.size()}  == 0">На данный
                    момент вы еще не проходили этот тест
                </caption>
                <thead>
                <tr>
                    <th scope="col">#</th>
                    <th scope="col">Дата прохождения</th>
                    <th align="center" valign="center" scope="col">Количество баллов</th>
                    <th scope="col">Итоговый комментарий</th>
                    <th align="center" valign="center" scope="col">Ваши ответы</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="attempt, iter : ${attempts}">
                    <th scope="row" th:utext="${iter.index}+1"></th>
                    <td th:text="${attempt.getFormattedTime()}"></td>
                    <td align="center" valign="center" th:text="${attempt.getMark()} + '/' + ${maxMark}"></td>
                    <td>
                        <span class="badge badge-success" th:if="${attempt.getPass()}" >Пройден</span>
                        <span class="badge badge-danger" th:if="${!attempt.getPass()}" >Не пройден</span>
                    </td>
                    <td align="center" valign="center"><a
                            th:href="@{/test/showResult/{id}(id=${attempt.id})}">Подробнее</a></td>
                </tr>
                </tbody>
            </table>
        </div>

    </div>
</div>
</body>
</html>